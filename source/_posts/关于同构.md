---
title: 关于同构
date: 2018-12-08 11:10:07
tags:
---

# 同构是什么
从技术层面来讲，同构就是把一份代码用于服务端和客户端共同使用。

### 重点写一写同构更深的理念化的一些东西。
同构是前端发展的一个探索，我们回顾前端的发展历史可也很清晰地认识到 同构 这个概念。

#### step 1 - web 1.0
传统的服务端模板渲染，这个时候的前端就是简单地写写 Dom 、CSS 和一些简单的 JS 交互，高级一点的就用后台语言套套模板（这个时候 JS 还被称为 前端的玩具。我清楚的记得上大学时教授满脸鄙视）;
#### step 2 - web 2.0
由于新的 JS 标准推出了 AJAX ，它貌似成为了打开前端世界潘多拉魔盒的一把钥匙，为后来前端事业发展奠定了基础。
这个时候的前端同学们，终于可以再脱离烦人的 JSP/PHP 模板语言，通过自己的 JS 完成数据构建，前后端分离这个概念也被广泛的运用于开发中。
但关于前后端职责的划分又出现了新的问题：‘各层职责重叠，并且是各玩儿各的’。并且业务、逻辑都太靠前，维护不利，跨端成本大，SEO，页面渲染等都存在问题。
#### step 3 - web 3.0
Ryan Dahl，Google 的软件工程师，他在09年发布了最初的 NodeJS。经过几年的发展，NodeJS 成为了解决前端 2.0 时代痛点的一个具有跨时代意义的解决方案。
通过 NodeJS ，前后端可以做到更低的耦合，职责划分也更加清晰。而 node 作为传统前端和后端的沟通桥梁，所带来的扩展意义和潜力十分巨大。这个时期，为解决客户端渲染带来的问题，服务端渲染/同构 的思维逐渐盛行。


## 同构的优点
1. SEO。来至于 node 直出的方式，使得爬虫能够顺利的爬到数据。
2. 首屏加载速度优化。由于 SPA 打包生成的 JS 往往都比较大，会导致页面加载后花费很长的时间来解析，也就造成了白屏问题。服务端渲染可以预先使到数据并渲染成最终 HTML 直接展示，理想情况下能避免白屏问题。
3. 共用前端代码。把一部分前端代码拿到服务端执行。（其实同构并没有节省前端的开发量，还要处处兼容 Node.js 不同的执行环境）

## 同构的问题
1. 服务器压力。把原来放在几百万浏览器端的工作拿过来给几台服务器做，这压力还是挺大的。
2. 务器端和浏览器环境差异。
3. 内存溢出。
4. 异步操作。同构，是将所有这些请求都在预先拿到结果才会渲染。而往往这些请求是有很多依赖条件的，很难调和。
5. store 必须是一个简单类型。store 是必须以字符串形式塞到前端，所以复杂类型是无法转义成字符串的，比如function。

## 由同构引发的思考
同构的运用，并不是为了同构。这个选择应该回归到业务领域，用来解决业务上遇到的问题，如 SEO，首屏渲染等问题。
而且必须要注意上面由同构产生的问题。